#!/bin/bash
root="$services_path/electrum"
sources="$root/ubuntu"
data="$root/data"
action="$command"
[[ ! -z $alter_cmd ]] && action="$alter_cmd"

function run_electrum {
    $sources/run_electrum $@ -D "$data"
}

case "$action" in
    --install)
        [[ $(which electrum) ]] && return
        $(rmkdir $root)
        echo "Registrando paquetes..."
        sudo apt-get install python3-pyqt5 libsecp256k1-0 python3-cryptography python3-setuptools python3-pip -y
        version="4.0.2"
        if [[ ! -f "$temp_path/Electrum.zip" ]]; then
            echo "Descargando Electrum..."
            wget -O $temp_path/Electrum.zip https://github.com/arcaela/electrum/archive/master.zip
        fi
        if [ -f "$temp_path/Electrum.zip" ]; then
            echo "Instalando Electrum"
            unzip "$temp_path/Electrum.zip" -d $services_path/
            mv $services_path/electrum-master/ $sources/
            $(add_bin electrum $base_path/arc)
            installed_apps=$((installed_apps+1))
        else
            echo "No hemos podido descargar Electrum"
        fi
    ;;
    --get)
        run_electrum -o getconfig ${params[0]}
    ;;
    --set)
        run_electrum -o setconfig ${params[0]} ${params[1]}
    ;;
    *)
        run_electrum
    ;;
esac